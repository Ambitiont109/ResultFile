(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{Smt5:function(e,t,n){"use strict";n.r(t),n.d(t,"PresetModule",(function(){return S}));var r=n("ofXK"),i=n("tyNb"),o=n("cp0P"),s=(n("3Ksp"),n("wd/R")),a=n("7njR"),d=n("PNcV"),c=n("fXoL"),l=n("aceb"),p=n("sYmb");function m(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275element"](1,"nb-user",7),c["\u0275\u0275elementEnd"]()),2&e){const e=c["\u0275\u0275nextContext"]().$implicit;c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("picture",e.child.photo)("name",e.child.first_name+" "+e.child.last_name)}}function u(e,t){1&e&&(c["\u0275\u0275element"](0,"nb-badge",8),c["\u0275\u0275pipe"](1,"translate")),2&e&&c["\u0275\u0275propertyInterpolate"]("text",c["\u0275\u0275pipeBind1"](1,1,"Booked"))}function f(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"nb-list-item",4),c["\u0275\u0275elementStart"](1,"div"),c["\u0275\u0275text"](2),c["\u0275\u0275pipe"](3,"date"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](4,m,2,2,"div",5),c["\u0275\u0275template"](5,u,2,3,"nb-badge",6),c["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate1"](" ",c["\u0275\u0275pipeBind2"](3,3,e.start,"HH:mm")," "),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngIf",e.booked),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",e.booked)}}function h(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"div",2),c["\u0275\u0275elementStart"](1,"nb-card"),c["\u0275\u0275elementStart"](2,"nb-card-header"),c["\u0275\u0275text"](3),c["\u0275\u0275pipe"](4,"date"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](5,"nb-card-body"),c["\u0275\u0275elementStart"](6,"nb-list"),c["\u0275\u0275template"](7,f,6,6,"nb-list-item",3),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=c["\u0275\u0275nextContext"]();c["\u0275\u0275advance"](3),c["\u0275\u0275textInterpolate1"](" ",c["\u0275\u0275pipeBind1"](4,2,e.date)," "),c["\u0275\u0275advance"](4),c["\u0275\u0275property"]("ngForOf",n.slots[e.id])}}const b=[{path:"",component:(()=>{class e{constructor(e,t){this.childService=e,this.appointmentService=t}ngOnInit(){this.classroom=this.childService.getCurrentClassName(),Object(o.a)({record:this.appointmentService.GetCurrentPresetRecord(),data:this.appointmentService.GetPresetAppointmentByClassroom(this.classroom)}).subscribe(e=>{this.presetRecord=e.record,this.apnts=e.data,this.presetRecord.presetItems.forEach(e=>{e.classroom==this.classroom&&(this.presetItem=e)}),this.slots=this._generateslotsInfo(this.apnts,this.classroom)})}_generateslotsInfo(e,t){let n={},r=this.presetItem,i=r.duration;return r?(r.timeranges.forEach(t=>{n[t.id]=[];let r=s(t.startTime),o=s(t.endTime);for(let a=r.clone();a.isBefore(o,"minutes");a.add(i,"minutes")){let r=e.find(e=>{let t=s(e.start),n=s(e.end);return a.isSame(t,"minutes")&&a.clone().add(i,"minutes").isSame(n)}),o={child:void 0,start:a.toDate(),end:a.clone().add(i,"minutes").toDate(),booked:!1};r&&(o.child=r.child,n[t.id].booked=!0),n[t.id].push(o)}}),console.log(n),n):{}}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](d.a),c["\u0275\u0275directiveInject"](a.a))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-preset"]],decls:8,vars:7,consts:[[1,"row"],["class","col-sm-4",4,"ngFor","ngForOf"],[1,"col-sm-4"],["style","position: relative;",4,"ngFor","ngForOf"],[2,"position","relative"],[4,"ngIf"],["status","danger","position","top right",3,"text",4,"ngIf"],[3,"picture","name"],["status","danger","position","top right",3,"text"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"nb-card"),c["\u0275\u0275elementStart"](1,"nb-card-header"),c["\u0275\u0275text"](2),c["\u0275\u0275pipe"](3,"translate"),c["\u0275\u0275pipe"](4,"translate"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](5,"nb-card-body"),c["\u0275\u0275elementStart"](6,"div",0),c["\u0275\u0275template"](7,h,8,4,"div",1),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate2"](" ",c["\u0275\u0275pipeBind1"](3,3,"Preset")," (",c["\u0275\u0275pipeBind1"](4,5,t.classroom)," ) "),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("ngForOf",t.presetItem.timeranges))},directives:[l.u,l.x,l.t,r.n,l.V,l.W,r.o,l.Bb,l.o],pipes:[p.c,r.e],styles:[""]}),e})()}];let g=(()=>{class e{}return e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.g.forChild(b)],i.g]}),e})();var v=n("p0MU");let S=(()=>{class e{}return e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.c,l.X,l.r,l.y,l.L,l.Cb,l.p,v.a,g]]}),e})()}}]);